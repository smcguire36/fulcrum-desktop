'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _recordValues = require('./record-values');

var _recordValues2 = _interopRequireDefault(_recordValues);

var _pgFormat = require('pg-format');

var _pgFormat2 = _interopRequireDefault(_pgFormat);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class PostgresRecordValues extends _recordValues2.default {
  static setupSearch(values, feature) {
    const searchableValue = feature.searchableValue;

    values.record_index_text = searchableValue;
    values.record_index = { raw: `to_tsvector('simple', ${(0, _pgFormat2.default)('%L', searchableValue)})` };

    return values;
  }

  static setupPoint(values, latitude, longitude) {
    const wkt = (0, _pgFormat2.default)('POINT(%s %s)', longitude, latitude);

    return { raw: `ST_Force2D(ST_SetSRID(ST_GeomFromText('${wkt}'), 4326))` };
  }
}
exports.default = PostgresRecordValues;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9tYWluL21vZGVscy9yZWNvcmQtdmFsdWVzL3Bvc3RncmVzLXJlY29yZC12YWx1ZXMuanMiXSwibmFtZXMiOlsiUG9zdGdyZXNSZWNvcmRWYWx1ZXMiLCJzZXR1cFNlYXJjaCIsInZhbHVlcyIsImZlYXR1cmUiLCJzZWFyY2hhYmxlVmFsdWUiLCJyZWNvcmRfaW5kZXhfdGV4dCIsInJlY29yZF9pbmRleCIsInJhdyIsInNldHVwUG9pbnQiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsIndrdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7Ozs7QUFDQTs7Ozs7O0FBRWUsTUFBTUEsb0JBQU4sZ0NBQWdEO0FBQzdELFNBQU9DLFdBQVAsQ0FBbUJDLE1BQW5CLEVBQTJCQyxPQUEzQixFQUFvQztBQUNsQyxVQUFNQyxrQkFBa0JELFFBQVFDLGVBQWhDOztBQUVBRixXQUFPRyxpQkFBUCxHQUEyQkQsZUFBM0I7QUFDQUYsV0FBT0ksWUFBUCxHQUFzQixFQUFDQyxLQUFNLHlCQUF5Qix3QkFBUyxJQUFULEVBQWVILGVBQWYsQ0FBaUMsR0FBakUsRUFBdEI7O0FBRUEsV0FBT0YsTUFBUDtBQUNEOztBQUVELFNBQU9NLFVBQVAsQ0FBa0JOLE1BQWxCLEVBQTBCTyxRQUExQixFQUFvQ0MsU0FBcEMsRUFBK0M7QUFDN0MsVUFBTUMsTUFBTSx3QkFBUyxjQUFULEVBQXlCRCxTQUF6QixFQUFvQ0QsUUFBcEMsQ0FBWjs7QUFFQSxXQUFPLEVBQUNGLEtBQU0sMENBQTBDSSxHQUFLLFlBQXRELEVBQVA7QUFDRDtBQWQ0RDtrQkFBMUNYLG9CIiwiZmlsZSI6InBvc3RncmVzLXJlY29yZC12YWx1ZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVjb3JkVmFsdWVzIGZyb20gJy4vcmVjb3JkLXZhbHVlcyc7XHJcbmltcG9ydCBwZ2Zvcm1hdCBmcm9tICdwZy1mb3JtYXQnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9zdGdyZXNSZWNvcmRWYWx1ZXMgZXh0ZW5kcyBSZWNvcmRWYWx1ZXMge1xyXG4gIHN0YXRpYyBzZXR1cFNlYXJjaCh2YWx1ZXMsIGZlYXR1cmUpIHtcclxuICAgIGNvbnN0IHNlYXJjaGFibGVWYWx1ZSA9IGZlYXR1cmUuc2VhcmNoYWJsZVZhbHVlO1xyXG5cclxuICAgIHZhbHVlcy5yZWNvcmRfaW5kZXhfdGV4dCA9IHNlYXJjaGFibGVWYWx1ZTtcclxuICAgIHZhbHVlcy5yZWNvcmRfaW5kZXggPSB7cmF3OiBgdG9fdHN2ZWN0b3IoJ3NpbXBsZScsICR7IHBnZm9ybWF0KCclTCcsIHNlYXJjaGFibGVWYWx1ZSkgfSlgfTtcclxuXHJcbiAgICByZXR1cm4gdmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIHNldHVwUG9pbnQodmFsdWVzLCBsYXRpdHVkZSwgbG9uZ2l0dWRlKSB7XHJcbiAgICBjb25zdCB3a3QgPSBwZ2Zvcm1hdCgnUE9JTlQoJXMgJXMpJywgbG9uZ2l0dWRlLCBsYXRpdHVkZSk7XHJcblxyXG4gICAgcmV0dXJuIHtyYXc6IGBTVF9Gb3JjZTJEKFNUX1NldFNSSUQoU1RfR2VvbUZyb21UZXh0KCckeyB3a3QgfScpLCA0MzI2KSlgfTtcclxuICB9XHJcbn1cclxuIl19